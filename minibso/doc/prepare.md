## Подготовка
### Экземпляр - заготовка

Генерируем экземпляр базы данных. Чтобы не терять время при
каждом изготовлении “КОПИИ” можно сделать бакап. Все скрипты для
заготовки находятся в “minibso/create/sql”. Некоторые из них надо
подправить. Контекст доступа и пароли к экземпляру “КОПИИ” необходимо
прописать в eggbld1.bat и eggbld3.bat. В скрипте deftbs.txt исправьте
описание стандартных табличных пространств IBSO и дополнительных REDO
логов.

Чтобы при импорте таблица занимала меньший размер, чем на
“ОРИГИНАЛЕ” ее необходимо создать заранее. Для генерации описания таких таблиц служит скрипт
gentab.sql. Он использует пакет DBMS_METADATA для извлечения из “ОРИГИНАЛА” определений 
таблиц и индексов, имеющих объем более 100 мегабайт или состоящих более чем из 10
экстентов или размещенных вне стандартных табличных пространств IBSO.
Критерии выбора можно изменить в строках 9, 16. Строки 61-64 и 91-94 необходимо 
переписать заново. В них задается пренос обектов в стандартные табличные пространства IBSO.

Эта процедура выполняется так:

    sh>sqlplus ibs/"password"@”ОРИГИНАЛ” @gentab.sql

В результате получаем два скрипта с описанием “негабаритных”
таблиц . Один для создания tabgen.txt и, на всякий случай, для удаления
tabdrop.txt.

Теперь подготовленная информация загружается в заготовленный
экземпляр Oracle. Запускаем eggbld1.bat. Затем копируем eggbld2.bat и
eggbld3.bat в каталог технологического ядра (туда, где находиться
FIRST9.BAT). Запускаем eggbld2.bat. Далее следует знакомый процесс
генерации схем AUD и AUDM. 

### Скрипты общего назначения

Основной скрипт находится в minibso/create. Он вызывается: 

    sh>./run.sh prep|exp|imp|union|all 

Параметр “all” служит для полного прогона всей процедуры
создания “КОПИИ”. Но прежде необходимо проверить каждую стадию в
отдельности. Поэтапное описание будет приведено далее.

Кроме того в этом каталоге находятся скрипты:

    sh>./testpf.sh - проверка параметров контекста на правильность. 

    sh>./del.sh data|logs|all - удаление промежуточных данных: дампов, протоколов, того и другого.

    sh>./finderr.sh - поиск ошибок в протоколах и объединение их.

Результат работы последнего скрипта - три файла: ошибки экспорта finderr.exp, ошибки импорта
finderr.imp, все ошибки finderr.all. В последнем объединяются протоколы
экспорта и импорта с удаленными вторичными сообщениями.

### Настройка параметров контекста

Параметры для экспорта из “ОРИГИНАЛА” находятся в каталоге
minibso/exp. Файлы profile.lin и profile.win для Linux и Cygwin
соответственно. Аналогично параметры для импорта в “КОПИЮ” находятся в
minibso/imp. 