<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title></title>

<style type="text/css" media="all">
@import url("./css/maven-base.css");
@import url("./css/maven-theme.css");
</style>
<meta name="Date-Revision-yyyymmdd" content="20121009" />
<meta http-equiv="Content-Language" content="ru" />
<script src="do_title.js" type="text/javascript"></script>
</head>

<body class="composite">
<div id="leftColumn">
<div id="navcolumn">
<h5>MinIbso</h5>
<ul>
<li><a href="index.html" title="Общие полжения">Основная идея</a></li>
<li><a href="download.html" title="Раздача">Раздача</a></li>
<li><a href="history.html" title="История">История</a></li>
<li><a href="thanks.html" title="Благодарности (вопросы)">Благодарности (вопросы)</a></li>
</ul>
<h5>Описание</h5>
<ul>
<li><a href="common.html" title="Общие полжения">Общие положения</a></li>
<li><a href="prepare.html" title="Подготовка">Подготовка</a></li>
<li><strong>Пренос данных</strong></li>
<li><a href="matching.html" title="Согласование данных">Согласование данных</a></li>
<li><a href="endnote.html" title="Полный цикл">Полный цикл</a></li>
<li><a href="dataadd.html" title="Дополнение данных">Дополнение данных</a></li>
</ul>
</div>
</div>
<div id="bodyColumn">
<div id="contentBox">
<div class="section">
<h2>Перенос данных</h2>
<h3> Оценка объема "КОПИИ"<a name="Оценка объема КОПИИ"></a>
</h3>
<p>Ограничения на объем копии задаются в файле:
./minibso/create/exp/prepare/insroot.sql Каждое ограничение это имя
таблицы и клауза WHERE определяющая информацию для “КОПИИ”. Здесь же
можно избавиться от излишней громоздкой информации: история состояний
объекта, данные для отчетности и пр.</p>
<p>Все ограничения будут автоматически влиять на выборку данных из зависимых таблиц.
Если в атрибуте "hidden" задать значение "Y" ограничение исключается из такого влияния.
Ссылки на эту таблицу будут иметь значение NULL.</p>
<p>После задания ограничений переходим в minibso/create и
запускаем только этап построения ограничений для зависимых таблиц.</p>
<p class="source">sh&gt;./run.sh prep</p>
<p>Время исполнения несколько минут. После окончания переходим в
minibso/create/estmsize и выполняем:</p>
<p class="source">sh&gt;./estart.sh</p>
<p>Время выполнения последнего скрипта соизмеримо по времени с
экспортом, с той лишь разницей, что данные не выгружаются. Затраты в 10
часов позволяют надеяться, что весь процесс создания “КОПИИ” уложится в
двое суток. После окончания, при помощи запросов из файла tabsizes.sql
смотрим итоговые объемы зависимых таблиц и таблиц, не попавших под
ограничения. Возможно, следует поправить insroot.sql и повторить.</p>
<p>Если инкарнация  "ОРИГИНАЛА" периодически обновляется, то оценку объема "КОПИИ" можно прервать.
Экспортировать промежуточные результаты работы:</p>
<p class="source">sh&gt;./epause.sh</p>
<p>На новой инкарнации восстанавливаем данные и продолжаем расчет объема.</p>
<p class="source">sh&gt;./econtinue.sh</p>

<p>Скрипт remove.sql предназначен для удаления вспомогательных
объектов после завершения работы.</p>
<h3> Экспорт данных<a name="Экспорт данных"></a>
</h3>
<p>Определившись с описанием для insroot.sql, можно запускать
выгрузку:</p>
<p class="source">sh&gt;./run.sh exp</p>
<p>Если “ОРИГИНАЛ” не сильно перегружен, то можно запустить
экспорт двумя параллельными заданиями. Одно для схемы и одно для
данных. Для этого в строке 28 в позиции 19 скрипта run.sh сотрите
символ “#”. Сам экспорт данных тоже можно делать в несколько
параллельных заданий. Для этого в строках 21, 25 в позиции 24 скрипта
minibso/create/exp/tables/exp.sh сотрите символ “#”. Итого максимум
четыре задания, одно на схему и три на данные.</p>
<p>После выполнения скрипта в каталоге minibso/create/data
размещены все дампы и протоколы их выгрузки.</p>
<h3> Импорт данных<a name="Импорт данных"></a>
</h3>
<p>Активируем экземпляр Oracle c заготовкой и запускаем импорт
данных</p>
<p class="source">sh&gt;./run.sh imp</p>
<p>Импортируются последовательно схема и все таблицы. Протоколы
записываются в каталог minibso/create/data. На импорт схемы тратится
приблизительно 4 - 5 часов. Импорт данных занимает больше суток.</p>
</div>
</div>
</div>
</body></html>